<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="README_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="README_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="README_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="README_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="README_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="README_files/navigation-1.1/tabsets.js"></script>
<link href="README_files/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="README_files/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">




</div>


<div id="rstrava" class="section level1">
<h1>rStrava</h1>
<div id="marcus-w.-beck-mbafs2012gmail.com-pedro-villarroel-pedrodvfgmail.com-daniel-padfield-dp323exeter.ac.uk" class="section level5">
<h5><em>Marcus W. Beck, <a href="mailto:mbafs2012@gmail.com">mbafs2012@gmail.com</a>, Pedro Villarroel, <a href="mailto:pedrodvf@gmail.com">pedrodvf@gmail.com</a>, Daniel Padfield, <a href="mailto:dp323@exeter.ac.uk">dp323@exeter.ac.uk</a></em></h5>
<p>Linux: <a href="https://travis-ci.org/fawda123/rStrava"><img src="https://travis-ci.org/fawda123/rStrava.svg?branch=master" alt="Travis-CI Build Status" /></a></p>
<p>Windows: <a href="https://ci.appveyor.com/project/fawda123/rStrava"><img src="https://ci.appveyor.com/api/projects/status/github/fawda123/rStrava?branch=master" alt="AppVeyor Build Status" /></a></p>
<p><a href="https://zenodo.org/badge/latestdoi/23404183"><img src="https://zenodo.org/badge/23404183.svg" alt="DOI" /></a></p>
<div class="figure">
<img src="api_logo_pwrdBy_strava_horiz_light.png" />

</div>
</div>
<div id="overview-and-installation" class="section level3">
<h3>Overview and installation</h3>
<p>This is the development repository for rStrava, an R package to access data from the Strava API. The package can be installed and loaded as follows:</p>
<pre class="r"><code>install.packages(&#39;devtools&#39;)
devtools::install_github(&#39;fawda123/rStrava&#39;)</code></pre>
</div>
<div id="issues-and-suggestions" class="section level3">
<h3>Issues and suggestions</h3>
<p>Please report any issues and suggestions on the <a href="https://github.com/fawda123/rStrava/issues">issues link</a> for the repository.</p>
</div>
<div id="package-overview" class="section level3">
<h3>Package overview</h3>
<p>The functions are in two categories depending on mode of use. The first category of functions scrape data from the public Strava website and the second category uses the API functions or relies on data from the API functions. The second category requires an authentication token. The help files for each category can be viewed using <code>help.search</code>:</p>
<pre class="r"><code>help.search(&#39;notoken&#39;, package = &#39;rStrava&#39;)
help.search(&#39;token&#39;, package = &#39;rStrava&#39;)</code></pre>
</div>
<div id="scraping-functions-no-token" class="section level3">
<h3>Scraping functions (no token)</h3>
<p>An example using the scraping functions:</p>
<pre class="r"><code># get athlete data for these guys
athl_fun(c(2837007, 2527465, 2140248), trace = FALSE)</code></pre>
<pre><code>## $`2837007`
## $`2837007`$units
## [1] &quot;mi&quot; &quot;h&quot;  &quot;m&quot;  &quot;ft&quot;
## 
## $`2837007`$location
## [1] &quot;Pensacola, FL&quot;
## 
## $`2837007`$current_month
##  Distance      Time Elevation 
##    173.10     12.15   2590.00 
## 
## $`2837007`$monthly
## Sep 2016      Oct      Nov      Dec Jan 2017      Feb      Mar      Apr 
## 450.9711 446.4158 327.9789 400.8632 373.5316 223.2079 378.0868 378.0868 
##      May      Jun      Jul      Aug      Sep 
## 255.0947 318.8684 327.9789 173.1000   0.0000 
## 
## $`2837007`$year_to_date
##       Distance           Time Elevation Gain          Rides 
##         2207.4          145.0        25778.0          189.0 
## 
## $`2837007`$all_time
##  Total Distance      Total Time Total Elev Gain     Total Rides 
##       19682.400        1193.283      138484.000        1474.000 
## 
## 
## $`2527465`
## $`2527465`$units
## [1] &quot;km&quot; &quot;h&quot;  &quot;m&quot;  &quot;m&quot; 
## 
## $`2527465`$location
## [1] &quot;Buenos Aires, Ciudad Aut√≥noma de Buenos Aires, Argentina&quot;
## 
## $`2527465`$current_month
##   Distance       Time  Elevation 
##  207.00000   12.93333 2454.00000 
## 
## $`2527465`$monthly
## Sep 2016      Oct      Nov      Dec Jan 2017      Feb      Mar      Apr 
##   393.30   320.85   538.20  1003.95   548.55   403.65   445.05   186.30 
##      May      Jun      Jul      Aug      Sep 
##     0.00     0.00    62.10   238.05   207.00 
## 
## $`2527465`$year_to_date
##       Distance           Time Elevation Gain          Rides 
##      2122.8000       113.8833     13398.0000        79.0000 
## 
## $`2527465`$all_time
##  Total Distance      Total Time Total Elev Gain     Total Rides 
##      16433.4000        903.0333     184354.0000        583.0000 
## 
## 
## $`2140248`
## $`2140248`$units
## [1] &quot;km&quot; &quot;h&quot;  &quot;m&quot;  &quot;m&quot; 
## 
## $`2140248`$location
## [1] &quot;Falmouth, England, United Kingdom&quot;
## 
## $`2140248`$current_month
##   Distance       Time  Elevation 
##  308.20000   15.88333 4819.00000 
## 
## $`2140248`$monthly
##  Sep 2016       Oct       Nov       Dec  Jan 2017       Feb       Mar 
##  54.38824 374.67451   0.00000   0.00000 271.94118  84.60392  72.51765 
##       Apr       May       Jun       Jul       Aug       Sep 
## 302.15686 284.02745 181.29412 429.06275 555.96863 308.20000 
## 
## $`2140248`$year_to_date
##       Distance           Time Elevation Gain          Rides 
##     2064.20000       85.71667    28660.00000       94.00000 
## 
## $`2140248`$all_time
##  Total Distance      Total Time Total Elev Gain     Total Rides 
##          9020.1           380.5        113503.0           574.0</code></pre>
</div>
<div id="api-functions-token" class="section level3">
<h3>API functions (token)</h3>
<div id="setup" class="section level4">
<h4>Setup</h4>
<p>These functions require a Strava account and a personal API, both of which can be obtained on the Strava website. The user account can be created by following instructions on the <a href="https://www.strava.com/">Strava homepage</a>. After the account is created, a personal API can be created under API tab of <a href="https://www.strava.com/settings/api">profile settings</a>. The user must have an application name (chosen by the user), client id (different from the athlete id), and an application secret to create the authentication token. Additional information about the personal API can be found <a href="https://strava.github.io/api/">here</a>. Every API retrieval function in the rStrava package requires an authentication token (called <code>stoken</code> in the help documents). The following is a suggested workflow for using the API functions with rStrava.</p>
<p>First, create the authentication token using your personal information from your API. Replace the <code>app_name</code>, <code>app_client_id</code>, and <code>app_secret</code> objects with the relevant info from your account.</p>
<pre class="r"><code>app_name &lt;- &#39;myappname&#39; # chosen by user
app_client_id  &lt;- &#39;myid&#39; # an integer, assigned by Strava
app_secret &lt;- &#39;xxxxxxxx&#39; # an alphanumeric secret, assigned by Strava

# create the authentication token
stoken &lt;- httr::config(token = strava_oauth(app_name, app_client_id, app_secret))</code></pre>
<p>Setting <code>cache = TRUE</code> for <code>strava_oauth</code> will create an authentication file in the working directory. This can be used in later sessions as follows:</p>
<pre class="r"><code>stoken &lt;- httr::config(token = readRDS(&#39;.httr-oauth&#39;)[[1]])</code></pre>
<p>Finally, the <code>get_heat_map</code> and <code>get_elev_prof</code> functions optionally retrieve elevation data from the Google Maps Elevation API. To use these features, an additional authentication key is required. Follow the instructions <a href="https://developers.google.com/maps/documentation/elevation/#api_key">here</a>. The key can be added to the R environment file for later use:</p>
<pre class="r"><code># save the key, do only once
cat(&quot;google_key=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n&quot;,
    file=file.path(normalizePath(&quot;~/&quot;), &quot;.Renviron&quot;),
    append=TRUE)

# retrieve the key, restart R if not found
mykey &lt;- Sys.getenv(&quot;google_key&quot;)</code></pre>
</div>
<div id="using-the-functions" class="section level4">
<h4>Using the functions</h4>
<p>The API retrieval functions are used with the token.</p>
<pre class="r"><code>myinfo &lt;- get_athlete(stoken, id = &#39;2837007&#39;)
head(myinfo)</code></pre>
<pre><code>## $id
## [1] 2837007
## 
## $username
## [1] &quot;beck_marcus&quot;
## 
## $resource_state
## [1] 3
## 
## $firstname
## [1] &quot;Marcus&quot;
## 
## $lastname
## [1] &quot;Beck&quot;
## 
## $city
## [1] &quot;Pensacola&quot;</code></pre>
<p>An example creating a heat map of activities:</p>
<pre class="r"><code># get activities, get activities by location, plot
my_acts &lt;- get_activity_list(stoken)
acts &lt;- lapply(my_acts, function(x) x$location_city) %in% c(&#39;Pensacola&#39;, &#39;Pensacola Beach&#39;, &#39;Milton&#39;) 
get_heat_map(my_acts, acts = which(acts), col = &#39;darkgreen&#39;, size = 2, dist = F)</code></pre>
<p><img src="README_files/figure-html/unnamed-chunk-10-1.png" /><!-- --></p>
<p>Plotting elevation and grade for a single ride:</p>
<pre class="r"><code># plot elevation along a single ride
get_heat_map(my_acts, acts = 1, alpha = 1, add_elev = T, f = 0.1, key = mykey, size = 2, col = &#39;Spectral&#39;, maptype = &#39;satellite&#39;, units = &#39;imperial&#39;)</code></pre>
<p><img src="README_files/figure-html/unnamed-chunk-11-1.png" /><!-- --></p>
<pre class="r"><code># plot % gradient along a single ride
get_heat_map(my_acts, acts = 1, alpha = 1, add_elev = T, f = 0.1, as_grad = T, key = mykey, size = 2, col = &#39;Spectral&#39;, expand = 5, maptype = &#39;satellite&#39;, units = &#39;imperial&#39;)</code></pre>
<p><img src="README_files/figure-html/unnamed-chunk-11-2.png" /><!-- --></p>
<p>Get elevation profiles for activities:</p>
<pre class="r"><code># get activities
my_acts &lt;- get_activity_list(stoken) 

get_elev_prof(my_acts, acts = 1, key = mykey, units = &#39;imperial&#39;)</code></pre>
<p><img src="README_files/figure-html/unnamed-chunk-12-1.png" /><!-- --></p>
<pre class="r"><code>get_elev_prof(my_acts, acts = 1, key = mykey, units = &#39;imperial&#39;, total = T)</code></pre>
<p><img src="README_files/figure-html/unnamed-chunk-12-2.png" /><!-- --></p>
<p>Plot average speed per split (km or mile) for an activity:</p>
<pre class="r"><code># plots for most recent activity
get_spdsplits(my_acts, stoken, acts = 1, units = &#39;imperial&#39;)</code></pre>
<p><img src="README_files/figure-html/unnamed-chunk-13-1.png" /><!-- --></p>
</div>
</div>
<div id="license" class="section level3">
<h3>License</h3>
<p>This package is released in the public domain under the creative commons license <a href="https://tldrlegal.com/license/creative-commons-cc0-1.0-universal">CC0</a>.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
